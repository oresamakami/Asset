<!DOCTYPE html>
<html xmlns:th="http://www.thymeleaf.org">
<head th:replace="~{fragments/layout :: head('資産登録 - 資産管理')}"></head>
<body>
<nav th:replace="~{fragments/layout :: navbar}"></nav>

<div class="container" style="max-width:720px">
    <h2 class="mb-4">
        <i class="bi bi-pc-display me-2"></i>
        <span th:text="${asset.id != null} ? '資産編集' : '資産登録'">資産登録</span>
    </h2>

    <div class="card p-4">
        <form th:action="${asset.id != null}
                  ? @{/assets/{id}(id=${asset.id})}
                  : @{/assets}"
              th:object="${asset}" method="post" enctype="multipart/form-data">

            <div class="row g-3">
                <!-- 資産種別 -->
                <div class="col-md-6">
                    <label class="form-label">資産種別 <span class="text-danger">*</span></label>
                    <select class="form-select" th:field="*{assetType}" required>
                        <option value="">-- 選択 --</option>
                        <option th:each="t : ${assetTypes}"
                                th:value="${t}" th:text="${t.displayName}"></option>
                    </select>
                </div>

                <!-- QRコードID (自動発行) -->
                <div class="col-md-6">
                    <label class="form-label">管理用QRコードID <span class="badge bg-secondary ms-1">自動発行</span></label>
                    <input type="text" class="form-control" th:field="*{qrCodeId}"
                           th:readonly="${asset.id == null}" readonly
                           style="background-color: #e9ecef;">
                    <div class="form-text" th:if="${asset.id == null}">登録時に自動発行されます</div>
                </div>

                <!-- 品名 -->
                <div class="col-md-6">
                    <label class="form-label">品名 <span class="text-danger">*</span></label>
                    <input type="text" class="form-control" th:field="*{productName}"
                           required placeholder="例: ThinkPad X1 Carbon">
                </div>

                <!-- 型名 -->
                <div class="col-md-6">
                    <label class="form-label">型名</label>
                    <input type="text" class="form-control" th:field="*{modelName}"
                           placeholder="例: 20U9CTO1WW">
                </div>

                <!-- 製造番号 -->
                <div class="col-md-6">
                    <label class="form-label">製造番号 (Serial)</label>
                    <input type="text" class="form-control" th:field="*{serialNumber}"
                           placeholder="例: PF-XXXXXX">
                </div>

                <!-- OS -->
                <div class="col-md-6">
                    <label class="form-label">OS</label>
                    <input type="text" class="form-control" th:field="*{os}"
                           placeholder="例: Windows 11 Pro">
                </div>

                <!-- CPU -->
                <div class="col-md-4">
                    <label class="form-label">CPU</label>
                    <input type="text" class="form-control" th:field="*{cpu}"
                           placeholder="例: Core i7-1365U">
                </div>

                <!-- メモリ -->
                <div class="col-md-4">
                    <label class="form-label">メモリ</label>
                    <input type="text" class="form-control" th:field="*{memory}"
                           placeholder="例: 16GB">
                </div>

                <!-- ストレージ -->
                <div class="col-md-4">
                    <label class="form-label">ストレージ</label>
                    <input type="text" class="form-control" th:field="*{storage}"
                           placeholder="例: 512GB SSD">
                </div>

                <!-- スペック (その他) -->
                <div class="col-12">
                    <label class="form-label">スペック (その他)</label>
                    <textarea class="form-control" th:field="*{spec}" rows="2"
                              placeholder="例: Wi-Fi 6E / Thunderbolt 4"></textarea>
                </div>

                <!-- 購入日 -->
                <div class="col-md-6">
                    <label class="form-label">購入日</label>
                    <input type="date" class="form-control" th:field="*{purchaseDate}">
                </div>

                <!-- ステータス -->
                <div class="col-md-6">
                    <label class="form-label">ステータス <span class="text-danger">*</span></label>
                    <select class="form-select" th:field="*{status}" required>
                        <option th:each="s : ${assetStatuses}"
                                th:value="${s}" th:text="${s.displayName}"></option>
                    </select>
                </div>

                <!-- 製品画像 -->
                <div class="col-12">
                    <label class="form-label">製品画像</label>
                    <input type="file" class="form-control" name="imageFile"
                           accept="image/*">
                    <div class="form-text">JPEG, PNG 等の画像ファイル (最大10MB)</div>
                    <!-- 既存画像プレビュー -->
                    <div th:if="${asset.imagePath != null}" class="mt-2">
                        <small class="text-muted">現在の画像:</small>
                        <div class="mt-1">
                            <img th:src="@{'/uploads/' + ${asset.imagePath}}"
                                 alt="製品画像" class="img-thumbnail" style="max-height:120px">
                        </div>
                    </div>
                </div>
            </div>

            <div class="d-flex gap-2 mt-4">
                <button type="submit" class="btn btn-primary">
                    <i class="bi bi-check-lg me-1"></i>保存
                </button>
                <a href="/assets" class="btn btn-outline-secondary">キャンセル</a>
            </div>
        </form>
    </div>
</div>

<footer th:replace="~{fragments/layout :: footer}"></footer>
</body>
</html>
